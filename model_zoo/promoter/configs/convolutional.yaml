# Promoter Dataset - Convolutional Architecture Configuration
dataset:
  name: promoter
  data_file: promoter_data.h5
  sequence_length: 1024
  num_classes: 4
  signal_dim: 1

# Hardware configuration
ngpus: 1
nnodes: 1
tokens: 4

# Training configuration
training:
  batch_size: 128
  accum: 1
  n_iters: 1000000
  snapshot_freq: 5000
  log_freq: 1000
  eval_freq: 1000
  snapshot_freq_for_preemption: 10000
  weight: standard
  snapshot_sampling: true
  ema: 0.9999

# Data configuration
data:
  train: promoter
  valid: promoter
  cache_dir: data

# Graph configuration
graph:
  type: uniform
  file: data
  report_all: false

# Noise configuration
noise:
  type: geometric
  sigma_min: 0.0001
  sigma_max: 20

# Sampling configuration
sampling:
  predictor: euler
  steps: 128
  noise_removal: true

# Evaluation configuration
eval:
  batch_size: 512
  perplexity: false
  perplexity_batch_size: 32

# SP-MSE validation configuration
sp_mse_validation:
  enabled: false  # Set to true to enable SP-MSE validation during training
  validation_freq: 5000  # Frequency in training steps to run SP-MSE validation
  validation_samples: 1000  # Number of samples from validation set (0 = use all)
  oracle_path: null  # Path to oracle model (auto-resolved if null)
  data_path: null  # Path to dataset file (auto-resolved if null)
  sampling_steps: null  # Number of sampling steps (auto-resolved if null)
  early_stopping_patience: null  # Stop training if no improvement for N validations (null = disabled)

# Optimization configuration
optim:
  weight_decay: 0
  optimizer: AdamW
  lr: 0.0003
  beta1: 0.9
  beta2: 0.999
  eps: 1.0e-08
  warmup: 2500
  grad_clip: 1.0

# Model configuration
model:
  name: small
  type: ddit
  architecture: convolutional
  hidden_size: 768
  cond_dim: 256
  conv_channels: 256
  length: 1024
  n_blocks: 12
  n_heads: 12
  scale_by_sigma: false
  dropout: 0.1
  class_dropout_prob: 0.1

# Logging configuration (optional)
wandb:
  enabled: false
  project: d3-dna-diffusion
  name: promoter-convolutional
  entity: null
  tags: []
  notes: ""

# Paths (relative to dataset directory)
paths:
  data_dir: "."
  oracle_model: "oracle_models/oracle_promoter_promoter_data.ckpt"
  checkpoints_dir: "checkpoints"